<p><a href="https://medium.com/handlebar-labs/graphql-authentication-with-react-native-apollo-part-1-2-9613aacd80b3">참고자료</a></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// app.js</span>
<span class="k">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">StackNavigator</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react-navigation</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// 1.0.0-beta.19</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ApolloClient</span><span class="p">,</span> <span class="nx">HttpLink</span><span class="p">,</span> <span class="nx">InMemoryCache</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">apollo-client-preset</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ApolloProvider</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react-apollo</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">setContext</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">apollo-link-context</span><span class="dl">"</span><span class="p">;</span>

<span class="k">import</span> <span class="nx">Register</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./Register</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Login</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./Login</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Profile</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./Profile</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">signIn</span><span class="p">,</span> <span class="nx">signOut</span><span class="p">,</span> <span class="nx">getToken</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./util</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">AuthStack</span> <span class="o">=</span> <span class="nx">StackNavigator</span><span class="p">({</span>
  <span class="na">Register</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">screen</span><span class="p">:</span> <span class="nx">Register</span><span class="p">,</span>
    <span class="na">navigationOptions</span><span class="p">:</span> <span class="p">{</span> <span class="na">headerTitle</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Register</span><span class="dl">"</span> <span class="p">}</span>
  <span class="p">},</span>
  <span class="na">Login</span><span class="p">:</span> <span class="p">{</span> <span class="na">screen</span><span class="p">:</span> <span class="nx">Login</span><span class="p">,</span> <span class="na">navigationOptions</span><span class="p">:</span> <span class="p">{</span> <span class="na">headerTitle</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Login</span><span class="dl">"</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">});</span>

<span class="kd">const</span> <span class="nx">LoggedInStack</span> <span class="o">=</span> <span class="nx">StackNavigator</span><span class="p">({</span>
  <span class="na">Profile</span><span class="p">:</span> <span class="p">{</span> <span class="na">screen</span><span class="p">:</span> <span class="nx">Profile</span><span class="p">,</span> <span class="na">navigationOptions</span><span class="p">:</span> <span class="p">{</span> <span class="na">headerTitle</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Profile</span><span class="dl">"</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">});</span>

<span class="kd">const</span> <span class="nx">httpLink</span> <span class="o">=</span> <span class="nx">newHttpLink</span><span class="p">({</span> <span class="na">uri</span><span class="p">:</span> <span class="dl">'</span><span class="s1">https://graphql서버주소</span><span class="dl">'</span><span class="p">});</span>
<span class="kd">const</span> <span class="nx">authLink</span> <span class="o">=</span> <span class="nx">setContext</span><span class="p">(</span><span class="k">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="p">{</span><span class="nx">headers</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">getToken</span><span class="p">();</span>

  <span class="k">return</span> <span class="p">{</span>
    <span class="p">...</span><span class="nx">headers</span><span class="p">,</span>
    <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">authorization</span><span class="p">:</span> <span class="nx">token</span> <span class="p">?</span><span class="s2">`Bearer $(token)`</span> <span class="p">:</span><span class="kc">null</span><span class="p">,</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">const</span> <span class="nx">link</span> <span class="o">=</span> <span class="nx">authLink</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">httpLInk</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ApolloClient</span><span class="p">({</span>
    <span class="nx">link</span><span class="p">,</span>
    <span class="na">cache</span><span class="p">:</span> <span class="k">new</span> <span class="nx">InMemoryCache</span><span class="p">(),</span>

<span class="p">})</span>

<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">App</span> <span class="kd">extends</span> <span class="nx">Component</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">loggedIn</span><span class="p">:</span> <span class="kc">false</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="k">async</span> <span class="nx">componentWillMount</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">getToken</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">token</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">loggedIn</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nx">handleChangeLoginState</span> <span class="o">=</span> <span class="p">(</span><span class="nx">loggedIn</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">jwt</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="nx">loggedIn</span> <span class="p">});</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">loggedIn</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">signIn</span><span class="p">(</span><span class="nx">jwt</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">signOut</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span><span class="p">(</span>
          <span class="o">&lt;</span><span class="nx">ApolloClient</span> <span class="nx">client</span><span class="o">=</span><span class="p">{</span><span class="nx">client</span><span class="p">}</span><span class="o">&gt;</span>
          <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">loggedIn</span> <span class="p">?</span>
            <span class="o">&lt;</span><span class="nx">LoggedInStack</span>
                <span class="nx">screenProps</span><span class="o">=</span><span class="p">{</span> <span class="na">changeLoginState</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleChangeLoginState</span> <span class="p">}</span>
            <span class="sr">/</span><span class="err">&gt;
</span>             <span class="p">:</span>
            <span class="o">&lt;</span><span class="nx">AuthStack</span>
                <span class="nx">screenProps</span><span class="o">=</span><span class="p">{</span> <span class="na">changeLoginState</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleChangeLoginState</span> <span class="p">}</span>
            <span class="sr">/</span><span class="err">&gt;
</span>        <span class="p">}</span>
        <span class="o">&lt;</span><span class="sr">/AolloClient</span><span class="err">&gt;
</span>      <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>bla</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// util.js</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">AsyncStorage</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react-native</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">AUTH_TOKEN</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">AUTH_TOKEN</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">token</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">getToken</span> <span class="o">=</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">token</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">token</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">token</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">AsyncStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="nx">AUTH_TOKEN</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">token</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">signIn</span> <span class="o">=</span> <span class="nx">newToken</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">token</span> <span class="o">=</span> <span class="nx">newToken</span><span class="p">;</span>
  <span class="k">return</span> <span class="nx">AsyncStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="nx">AUTH_TOKEN</span><span class="p">,</span> <span class="nx">newToken</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">signOut</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">token</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
  <span class="k">return</span> <span class="nx">AsyncStorage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="nx">AUTH_TOKEN</span><span class="p">);</span>
<span class="p">};</span>
</code></pre></div></div>

<p>bla</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//login.js</span>
<span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span>
  <span class="nx">Container</span><span class="p">,</span>
  <span class="nx">Button</span><span class="p">,</span>
  <span class="nx">Content</span><span class="p">,</span>
  <span class="nx">Form</span><span class="p">,</span>
  <span class="nx">Item</span><span class="p">,</span>
  <span class="nx">Input</span><span class="p">,</span>
  <span class="nx">Text</span>
<span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">native-base</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">gql</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">graphql-tag</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">graphql</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react-apollo</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">class</span> <span class="nx">Login</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">email</span><span class="p">:</span> <span class="dl">""</span><span class="p">,</span>
      <span class="na">emailError</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="na">password</span><span class="p">:</span> <span class="dl">""</span><span class="p">,</span>
      <span class="na">passwordError</span><span class="p">:</span> <span class="kc">false</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="nx">handleInputChange</span> <span class="o">=</span> <span class="p">(</span><span class="nx">field</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">newState</span> <span class="o">=</span> <span class="p">{</span>
      <span class="p">...</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">,</span>
      <span class="p">[</span><span class="nx">field</span><span class="p">]:</span> <span class="nx">value</span>
    <span class="p">};</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">(</span><span class="nx">newState</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="nx">handleSubmit</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">password</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">email</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">emailError</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">emailError</span><span class="p">:</span> <span class="kc">false</span> <span class="p">});</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">password</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">passwordError</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">passwordError</span><span class="p">:</span> <span class="kc">false</span> <span class="p">});</span>

    <span class="c1">// return this.props.screenProps.changeLoginState(true);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">props</span>
      <span class="p">.</span><span class="nx">login</span><span class="p">(</span><span class="nx">email</span><span class="p">,</span> <span class="nx">password</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(({</span> <span class="nx">data</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">screenProps</span><span class="p">.</span><span class="nx">changeLoginState</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">login</span><span class="p">.</span><span class="nx">jwt</span><span class="p">);</span>
      <span class="p">})</span>
      <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="sr">/email/i</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">message</span><span class="p">))</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">emailError</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="sr">/password/i</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">message</span><span class="p">))</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">passwordError</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
        <span class="p">}</span>
      <span class="p">});</span>
  <span class="p">};</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">emailError</span><span class="p">,</span> <span class="nx">passwordError</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>

    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">Container</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">Content</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">Form</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">Item</span> <span class="nx">error</span><span class="o">=</span><span class="p">{</span><span class="nx">emailError</span><span class="p">}</span><span class="o">&gt;</span>
              <span class="o">&lt;</span><span class="nx">Input</span>
                <span class="nx">placeholder</span><span class="o">=</span><span class="dl">"</span><span class="s2">Email</span><span class="dl">"</span>
                <span class="nx">onChangeText</span><span class="o">=</span><span class="p">{</span><span class="nx">value</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleInputChange</span><span class="p">(</span><span class="dl">"</span><span class="s2">email</span><span class="dl">"</span><span class="p">,</span> <span class="nx">value</span><span class="p">)}</span>
                <span class="nx">keyboardType</span><span class="o">=</span><span class="dl">"</span><span class="s2">email-address</span><span class="dl">"</span>
                <span class="nx">autoCapitalize</span><span class="o">=</span><span class="dl">"</span><span class="s2">none</span><span class="dl">"</span>
                <span class="nx">autoCorrect</span><span class="o">=</span><span class="p">{</span><span class="kc">false</span><span class="p">}</span>
              <span class="sr">/</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="sr">/Item</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="nx">Item</span> <span class="nx">error</span><span class="o">=</span><span class="p">{</span><span class="nx">passwordError</span><span class="p">}</span><span class="o">&gt;</span>
              <span class="o">&lt;</span><span class="nx">Input</span>
                <span class="nx">placeholder</span><span class="o">=</span><span class="dl">"</span><span class="s2">Password</span><span class="dl">"</span>
                <span class="nx">onChangeText</span><span class="o">=</span><span class="p">{</span><span class="nx">value</span> <span class="o">=&gt;</span>
                  <span class="k">this</span><span class="p">.</span><span class="nx">handleInputChange</span><span class="p">(</span><span class="dl">"</span><span class="s2">password</span><span class="dl">"</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span>
                <span class="p">}</span>
                <span class="nx">autoCapitalize</span><span class="o">=</span><span class="dl">"</span><span class="s2">none</span><span class="dl">"</span>
                <span class="nx">autoCorrect</span><span class="o">=</span><span class="p">{</span><span class="kc">false</span><span class="p">}</span>
                <span class="nx">secureTextEntry</span>
              <span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="sr">/Item</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="sr">/Form</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="nx">Button</span> <span class="nx">full</span> <span class="nx">onPress</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleSubmit</span><span class="p">}</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">Text</span><span class="o">&gt;</span><span class="nx">Sign</span> <span class="nx">In</span><span class="o">&lt;</span><span class="sr">/Text</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="sr">/Button</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="sr">/Content</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="sr">/Container</span><span class="err">&gt;
</span>    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">graphql</span><span class="p">(</span>
  <span class="nx">gql</span><span class="s2">`
    mutation LogIn($email: String!, $password: String!) {
      login(email: $email, password: $password) {
        _id
        email
        jwt
      }
    }
  `</span><span class="p">,</span>
  <span class="p">{</span>
    <span class="na">props</span><span class="p">:</span> <span class="p">({</span> <span class="nx">mutate</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">({</span>
      <span class="na">login</span><span class="p">:</span> <span class="p">(</span><span class="nx">email</span><span class="p">,</span> <span class="nx">password</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">mutate</span><span class="p">({</span> <span class="na">variables</span><span class="p">:</span> <span class="p">{</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">password</span> <span class="p">}</span> <span class="p">})</span>
    <span class="p">})</span>
  <span class="p">}</span>
<span class="p">)(</span><span class="nx">Login</span><span class="p">);</span>
</code></pre></div></div>

<p>bla</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// register.js</span>
<span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span>
  <span class="nx">Container</span><span class="p">,</span>
  <span class="nx">Button</span><span class="p">,</span>
  <span class="nx">Content</span><span class="p">,</span>
  <span class="nx">Form</span><span class="p">,</span>
  <span class="nx">Item</span><span class="p">,</span>
  <span class="nx">Input</span><span class="p">,</span>
  <span class="nx">Text</span>
<span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">native-base</span><span class="dl">"</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span><span class="nx">graphql</span><span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react-apollo</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">gql</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">graph-tag</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">class</span> <span class="nx">Register</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">email</span><span class="p">:</span> <span class="dl">""</span><span class="p">,</span>
      <span class="na">emailError</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="na">password</span><span class="p">:</span> <span class="dl">""</span><span class="p">,</span>
      <span class="na">passwordError</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="na">confirmPassword</span><span class="p">:</span> <span class="dl">""</span><span class="p">,</span>
      <span class="na">confirmPasswordError</span><span class="p">:</span> <span class="kc">false</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="nx">handleInputChange</span> <span class="o">=</span> <span class="p">(</span><span class="nx">field</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">newState</span> <span class="o">=</span> <span class="p">{</span>
      <span class="p">...</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">,</span>
      <span class="p">[</span><span class="nx">field</span><span class="p">]:</span> <span class="nx">value</span>
    <span class="p">};</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">(</span><span class="nx">newState</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="nx">handleSubmit</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">password</span><span class="p">,</span> <span class="nx">confirmPassword</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">email</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">emailError</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">emailError</span><span class="p">:</span> <span class="kc">false</span> <span class="p">});</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">password</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">passwordError</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">passwordError</span><span class="p">:</span> <span class="kc">false</span> <span class="p">});</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">confirmPassword</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">confirmPasswordError</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">confirmPasswordError</span><span class="p">:</span> <span class="kc">false</span> <span class="p">});</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">password</span> <span class="o">!==</span> <span class="nx">confirmPassword</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">passwordError</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="na">confirmPasswordError</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">passwordError</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">confirmPasswordError</span><span class="p">:</span> <span class="kc">false</span> <span class="p">});</span>

    <span class="c1">// return this.props.screenProps.changeLoginState(true);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">props</span>
      <span class="p">.</span><span class="nx">signup</span><span class="p">(</span><span class="nx">email</span><span class="p">,</span> <span class="nx">passowrd</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(({</span><span class="nx">data</span><span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">screenProps</span><span class="p">.</span><span class="nx">changeLoginState</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">signup</span><span class="p">.</span><span class="nx">jwt</span><span class="p">)</span><span class="dl">'</span><span class="s1">
      })
      .catch(e =&gt; {
        if (/email/i.test(e.message)) {
          this.setState({ emailError: true});
        }
        if (/password/i.test(e.message)) {
          this.setState({ passwordError: true});
        }
      })

  };

  render() {
    const { navigation } = this.props;
    const { emailError, passwordError, confirmPasswordError } = this.state;

    return (
      &lt;Container&gt;
        &lt;Content&gt;
          &lt;Form&gt;
            &lt;Item error={emailError}&gt;
              &lt;Input
                placeholder="Email"
                onChangeText={value =&gt; this.handleInputChange("email", value)}
                keyboardType="email-address"
                autoCapitalize="none"
                autoCorrect={false}
              /&gt;
            &lt;/Item&gt;
            &lt;Item error={passwordError}&gt;
              &lt;Input
                placeholder="Password"
                onChangeText={value =&gt;
                  this.handleInputChange("password", value)
                }
                autoCapitalize="none"
                autoCorrect={false}
                secureTextEntry
              /&gt;
            &lt;/Item&gt;
            &lt;Item last error={confirmPasswordError}&gt;
              &lt;Input
                placeholder="Confirm Password"
                onChangeText={value =&gt;
                  this.handleInputChange("confirmPassword", value)
                }
                autoCapitalize="none"
                autoCorrect={false}
                secureTextEntry
              /&gt;
            &lt;/Item&gt;
          &lt;/Form&gt;
          &lt;Button full onPress={this.handleSubmit}&gt;
            &lt;Text&gt;Sign Up&lt;/Text&gt;
          &lt;/Button&gt;
          &lt;Button full transparent onPress={() =&gt; navigation.navigate("Login")}&gt;
            &lt;Text&gt;Sign In&lt;/Text&gt;
          &lt;/Button&gt;
        &lt;/Content&gt;
      &lt;/Container&gt;
    );
  }
}

export default graphql(
  gql`
    mutation SignUp($email: String!, $password: String!) {
      signup(email: $email, password: $password) {
        _id
        email
        jwt
      }
    }
  `,
  {
    props: ({ mutate }) =&gt; {
      signup: (email, password) =&gt; mutate({ variables: { email, passwrod } });
    }
  }
)(Register);
</span></code></pre></div></div>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// profile.js</span>

<span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">View</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react-native</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Container</span><span class="p">,</span> <span class="nx">Text</span><span class="p">,</span> <span class="nx">Button</span><span class="p">,</span> <span class="nx">Content</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">native-base</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">graphql</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react-apollo</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">gql</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">graphql-tag</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">class</span> <span class="nx">Logout</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">handleLogout</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">screenProps</span><span class="p">.</span><span class="nx">changeLoginState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">currentUser</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">Container</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">Content</span><span class="o">&gt;</span>
          <span class="p">{</span><span class="nx">currentUser</span> <span class="o">&amp;&amp;</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">View</span><span class="o">&gt;</span>
              <span class="o">&lt;</span><span class="nx">Text</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">currentUser</span><span class="p">.</span><span class="nx">_id</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/Text</span><span class="err">&gt;
</span>              <span class="o">&lt;</span><span class="nx">Text</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">currentUser</span><span class="p">.</span><span class="nx">password</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/Text</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="sr">/View</span><span class="err">&gt;
</span>          <span class="p">)}</span>
          <span class="o">&lt;</span><span class="nx">Button</span> <span class="nx">full</span> <span class="nx">onPress</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleLogout</span><span class="p">}</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">Text</span><span class="o">&gt;</span><span class="nx">Log</span> <span class="nx">Out</span><span class="o">&lt;</span><span class="sr">/Text</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="sr">/Button</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="sr">/Content</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="sr">/Container</span><span class="err">&gt;
</span>    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">graphql</span><span class="p">(</span>
  <span class="nx">gql</span><span class="s2">`
    query User {
      currentUser {
        _id
        email
      }
    }
  `</span>
<span class="p">)(</span><span class="nx">Logout</span><span class="p">);</span>
</code></pre></div></div>
